#!/bin/bash

###############################################################################
############### Change to project directory ###################################
###############################################################################
cd /mnt/vivitsa

###############################################################################
############### Build project #################################################
###############################################################################
echo -e "\nBuilding project..."
./build.sh -s

###############################################################################
############### Launch QEMU in background and run tests #######################
###############################################################################
echo -e "\nRunning tests by launching QEMU in background..."
./travisRun.sh

###############################################################################
############### Wait for tests to complete ####################################
###############################################################################
echo -e "\nWaiting for tests to be completed... Approximately 1 minute..!!!\n"
sleep 60

###############################################################################
############### Print the tests output to console and delete log file  ########
###############################################################################
cat qemu.log
rm qemu.log

###############################################################################
############### Kill background process #######################################
###############################################################################
echo -e "\nTests completed with the above results..."
echo -e "\nStopping QEMU"
pkill qemu
